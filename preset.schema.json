{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"title": "Settings of the acoustic system",
	"description": "Settings file for the acoustic system describing the sample space, beam and topology.\nSchema on github: https://github.com/Engineer2B/PowerCalculator-Schemas",
	"type": "object",
	"required": [
		"Sampling",
		"System"
	],
	"$defs": {
		"Extremum": {
			"properties": {
				"Min": {
					"type": "number",
					"description": "The minimimal value."
				},
				"Max": {
					"type": "number",
					"description": "The maximal value."
				}
			}
		},
		"Vector": {
			"type": "array",
			"maxItems": 3,
			"minItems": 3,
			"items": {
				"type": "number"
			}
		}
	},
	"properties": {
		"Sampling": {
			"type": "object",
			"description": "Settings of the sampling space.",
			"required": [
				"LatticeSpacing",
				"LatticeExtrema",
				"RaysPerElement",
				"PowerLimit",
				"ThetaMax"
			],
			"properties": {
				"LatticeSpacing": {
					"description": "Spacing between points inside the lattice box in [m, m, m].",
					"$ref": "#/$defs/Vector"
				},
				"LatticeExtrema": {
					"type": "object",
					"description": "Minimal and maximal values that describe the lattice box in [m].",
					"required": [
						"X",
						"Y",
						"Z"
					],
					"properties": {
						"X": {
							"description": "Minimal and maximal X values of the box in [m].",
							"$ref": "#/$defs/Extremum"
						},
						"Y": {
							"description": "Minimal and maximal Y values of the box in [m].",
							"$ref": "#/$defs/Extremum"
						},
						"Z": {
							"description": "Minimal and maximal Z values of the box in [m].",
							"$ref": "#/$defs/Extremum"
						}
					}
				},
				"RaysPerElement": {
					"type": "integer",
					"description": "Number of rays per transducer element.",
					"minimum": 1
				},
				"PowerLimit": {
					"type": "number",
					"description": "If the power of the ray goes below this limit in [W], no new rays can be generated from the ray.",
					"exclusiveMinimum": 0
				},
				"ThetaMax": {
					"type": "number",
					"description": "Maximal angle up to which rays are generated by the transducer elements in [rad]. Theta is defined for each individual transducer element as the angle between the direction of the element and the plane in which it lies.",
					"exclusiveMinimum": 0,
					"maximum": 1.5707963267948966
				}
			}
		},
		"System": {
			"type": "object",
			"description": "Settings of the system configuration.",
			"required": [
				"ObjectTransformation",
				"TransducerSettings"
			],
			"properties": {
				"ObjectTransformation": {
					"description": "Transformation applied to the object.",
					"required": [
						"Inclination",
						"Azimuth",
						"ScaleFactor",
						"Translation"
					],
					"properties": {
						"Inclination": {
							"type": "number",
							"description": "X or Y axis rotation angle in radians."
						},
						"Azimuth": {
							"type": "number",
							"description": "Z axis rotation angle in radians."
						},
						"ScaleFactor": {
							"type": "number",
							"description": "Scalar multiplier."
						},
						"Translation": {
							"description": "Vector of translation in [m, m, m] (if ScaleFactor is 1).",
							"$ref": "#/$defs/Vector"
						}
					}
				},
				"TransducerSettings": {
					"type": "object",
					"required": [
						"Focus",
						"Power",
						"Frequency",
						"Trajectory",
						"ImagingTiming"
					],
					"description": "Settings of the transducer.",
					"properties": {
						"Focus": {
							"description": "Position towards which the focus is phase-shifted in [m, m, m].",
							"items": {
								"$ref": "#/$defs/Vector"
							}
						},
						"Power": {
							"type": "array",
							"minItems": 1,
							"description": "Total amount of power that the transducer sends out in the current sonication trajectory in [W].",
							"items": {
								"type": "number",
								"exclusiveMinimum": 0
							}
						},
						"Frequency": {
							"type": "array",
							"minItems": 1,
							"description": "Frequency at which the transducer elements oscillate in the current sonication trajectory in [Hz].",
							"items": {
								"type": "number",
								"exclusiveMinimum": 0
							}
						},
						"Trajectory": {
							"type": "array",
							"minItems": 1,
							"description": "Sonication trajectory which can be treated as a single heat production averaged over the region.",
							"items": {
								"type": "object",
								"required": [
									"Focus_index_L",
									"Begin",
									"End",
									"Interval"
								],
								"properties": {
									"Focus_index_L": {
										"type": "array",
										"minItems": 1,
										"items": {
											"type": "integer",
											"exclusiveMinimum": 0
										},
										"description": "Index to the rows of the focus matrix, where each row indicates a focus position. E.g., [3,4,5] would indicate this trajectory uses focus points 3, 4, and 5."
									},
									"Begin": {
										"type": "number",
										"minimum": 0,
										"description": "Start time of the sonication trajectory in [s]."
									},
									"End": {
										"type": "number",
										"minimum": 0,
										"description": "End time of the sonication trajectory in [s]."
									},
									"Interval": {
										"type": "number",
										"exclusiveMinimum": 0,
										"description": "Time spend on each focus within the sonication trajectory in [s]."
									}
								}
							}
						},
						"ImagingTiming": {
							"$ref": "#/$defs/Extremum",
							"description": "The timeframe accross which imaging occurs in [s]."
						}
					}
				}
			}
		}
	}
}
